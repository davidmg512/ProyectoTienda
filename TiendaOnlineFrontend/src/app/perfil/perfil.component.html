
<head>
    <!-- ... Otros elementos del encabezado ... -->
    
    <!-- Agrega los enlaces a Bootstrap CSS y JavaScript -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>

  <div class="profile-container">
    <mat-card class="profile-card">
      <mat-card-header>
        <div style="text-align: center; width: 100%; margin-bottom: 30px;">
          <mat-card-title style="font-size: 25px;">{{'Perfil' | translate}}</mat-card-title>
        </div>
      </mat-card-header>

      <mat-card-content class="carta">
      
        <mat-tab-group>
          <mat-tab label="{{ 'DatosUsuario' | translate}}"> 
            
                <div class="detail">
                  <span class="detail-label">{{ 'Nombre' | translate }}:</span>
                  <span class="detail-value">{{ userNombre }}</span>
                </div>
                <div class="detail">
                  <span class="detail-label">{{ 'Apellidos' | translate }}:</span>
                  <span class="detail-value">{{ userApellido }}</span>
                </div>
                <div class="detail">
                  <span class="detail-label">Email:</span>
                  <span class="detail-value">{{ userEmail }}</span>
                </div>
                <div class="detail" style="margin-bottom: 30px;">
                  <span class="detail-label">{{ 'Telefono' | translate }}:</span>
                  <span class="detail-value">{{ userTelefono }}</span>
                </div>

            <div class="d-flex justify-content-between align-items-center">
              <div>
                <button style="margin-right: 10px" type="button" class="custom-button" routerLink="/perfil/editar">
                  {{ 'EditarPerfil' | translate }}
                </button>
                <button type="button" class="custom-button" (click)="onClickResetPassword()">{{ 'CambiarContrasenya' | translate}}</button>
              </div>
              <button *ngIf="admin" type="button" class="custom-button"  routerLink="/panelAdministracion">{{ 'PanelAdministracion' | translate}}</button>
            </div>
            
            
            <div style="margin-top: 10px;" *ngIf="resetPasswordString" class="alert alert-primary">{{ 'ContrasenyaCorreo' | translate }}</div>

          </mat-tab>
          
          <mat-tab label="{{ 'Direcciones' | translate}}">

            <div style="margin-top: 50px">

              <mat-accordion>
                <mat-expansion-panel style="margin-top: 10px;" *ngFor="let address of userAddresses; let i = index">
                  <mat-expansion-panel-header (click)="fillAddressForm(address)">

                    <mat-panel-title>
                      Dirección {{ i + 1 }}
                    </mat-panel-title>
                    
                    <mat-panel-description>
                      {{ address.address_country }}, {{ address.address_province }}, {{address.address_town}}, {{address.addres_postal}}, {{address.street_and_number}}, {{address.additional_data}}
                    </mat-panel-description>
                  </mat-expansion-panel-header>


                  <form *ngIf="selectedAddress === address" [formGroup]="addressForm" (submit)="onUpdateAddress(address)" class="address-form">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Pais</mat-label>
                      <input type="text" matInput formControlName="country" placeholder="Placeholder">
                    </mat-form-field>

                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Provincia</mat-label>
                      <input matInput formControlName="province" placeholder="Provincia">
                    </mat-form-field>

                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Población</mat-label>
                      <input matInput formControlName="town" placeholder="Población">
                    </mat-form-field>

                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>Calle</mat-label>
                      <input matInput formControlName="street" placeholder="Calle">
                    </mat-form-field>

                    <mat-form-field class="full-width" style="width: 100%;" appearance="outline">
                      <mat-label>Información Adicional</mat-label>
                      <textarea matInput formControlName="additionalInfo" placeholder="Información Adicional"></textarea>
                    </mat-form-field>
                    <br>
                    <button class="float-end" style="margin-left: 10px;" mat-mini-fab color="primary" type="submit">
                      <mat-icon>save</mat-icon>
                    </button>
                  </form>

                  

                  <button class="float-end" style="margin-left: 10px;" mat-mini-fab color="warn" (click)="onDeleteAddress(address)">
                    <mat-icon>delete</mat-icon>
                  </button>

                </mat-expansion-panel>
              </mat-accordion>

              

            </div>
             
            <mat-list>
              <mat-list-item role="listitem" *ngFor="let address of userAddresses">
                
                
              </mat-list-item>
            </mat-list>  
          
            <button style="margin-right: 10px;" type="button" class="custom-button" (click)="showPopup()">{{ 'NuevaDireccion' | translate }}</button>
            
            <div *ngIf="isPopupVisible" class="popup">
              <form (submit)="onSubmitAddDirection()">

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'Pais' | translate }}:</mat-label>
                    <input type="text" id="country" name="country" [(ngModel)]="formData.address_country" required matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'Provincia' | translate }}:</mat-label>
                    <input type="text" id="province" name="province" [(ngModel)]="formData.address_province" matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'Pueblo' | translate }}</mat-label>
                    <input type="text" id="town" name="town" [(ngModel)]="formData.address_town" required matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'CodigoPostal' | translate }}:</mat-label>
                    <input type="text" id="postal" name="postal" [(ngModel)]="formData.address_postal" required matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'CalleyNumero' | translate }}:</mat-label>
                    <input type="text" id="streetandnumber" name="streetandnumber" [(ngModel)]="formData.street_and_number" required matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <div class="mb-3">
                  <mat-form-field appearance="outline">
                    <mat-label>{{ 'DatosAdicionales' | translate }}:</mat-label>
                    <input type="text" id="additionaldata" name="additionaldata" [(ngModel)]="formData.additional_data" required matInput placeholder="Placeholder">
                  </mat-form-field>
                </div>

                <button style="margin-right: 10px;" type="submit" class="btn btn-primary" >{{ 'NuevaDireccion' | translate }}</button>

              </form>
              
              <button style="margin-top: 10px;" class="btn btn-primary" (click)="hidePopup()" >{{ 'Cancelar' | translate }}</button>


            </div>
            
          </mat-tab>

          <mat-tab label="{{ 'MetodosPago' | translate}}">   </mat-tab>
          <mat-tab label="{{ 'Pedidos' | translate}}">   </mat-tab>

        </mat-tab-group>

      </mat-card-content>

        
    </mat-card>
</div>